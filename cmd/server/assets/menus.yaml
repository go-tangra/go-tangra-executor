# Executor Module Menu Definitions
# This file defines the menu structure for the Executor module
# Used by admin service for dynamic menu registration

module:
  id: executor
  name: Executor
  description: Remote script execution management with hash verification and audit logging

menus:
  - id: executor
    parent_id: null
    type: CATALOG
    name: Executor
    path: /executor
    icon: lucide:terminal
    order: 500
    authority:
      - platform:admin
      - tenant:manager

  - id: executor-scripts
    parent_id: executor
    type: MENU
    name: Scripts
    path: scripts
    component: app/executor/scripts/index.vue
    icon: lucide:file-code
    order: 1
    authority:
      - platform:admin
      - tenant:manager

  - id: executor-executions
    parent_id: executor
    type: MENU
    name: Executions
    path: executions
    component: app/executor/executions/index.vue
    icon: lucide:play
    order: 2
    authority:
      - platform:admin
      - tenant:manager

dashboard_widgets:
  - id: executor.total_scripts
    name: Scripts
    description: Active and total script counts
    icon: lucide:file-code
    widget_type: stat_card
    data_source:
      endpoint: /admin/v1/modules/executor/v1/statistics
      method: GET
    data_mapping:
      value_path: enabledScripts
      total_path: totalScripts
      label: Active Scripts
    default_size:
      width: 3
      height: 1
    tags: [executor, overview]
    authority: [platform:admin, tenant:manager]

  - id: executor.execution_success
    name: Execution Success Rate
    description: Percentage of successful executions
    icon: lucide:gauge
    widget_type: gauge
    data_source:
      endpoint: /admin/v1/modules/executor/v1/statistics
      method: GET
    data_mapping:
      value_path: successRate
      label: Success Rate
    default_size:
      width: 4
      height: 2
    tags: [executor, chart]
    authority: [platform:admin, tenant:manager]

  - id: executor.total_executions
    name: Executions
    description: Completed and total execution counts
    icon: lucide:play
    widget_type: stat_card
    data_source:
      endpoint: /admin/v1/modules/executor/v1/statistics
      method: GET
    data_mapping:
      value_path: completedExecutions
      total_path: totalExecutions
      label: Completed
    default_size:
      width: 3
      height: 1
    tags: [executor, overview]
    authority: [platform:admin, tenant:manager]

  - id: executor.recent_errors
    name: Recent Execution Errors
    description: Most recent script execution failures
    icon: lucide:alert-triangle
    widget_type: list
    data_source:
      endpoint: /admin/v1/modules/executor/v1/statistics
      method: GET
    data_mapping:
      items_path: recentErrors
      title_field: scriptName
      subtitle_field: clientId
      detail_field: errorOutput
      time_field: createdAt
      status_field: status
    default_size:
      width: 4
      height: 2
    tags: [executor, errors]
    authority: [platform:admin, tenant:manager]

permission_groups:
  - name: Executor
    module: executor
    description: Executor Module Permissions
    permissions:
      - name: View Scripts
        code: executor.script.view
        description: View scripts list
      - name: Manage Scripts
        code: executor.script.manage
        description: Create, update, and delete scripts
      - name: Manage Assignments
        code: executor.assignment.manage
        description: Assign and unassign scripts to clients
      - name: Trigger Execution
        code: executor.execution.trigger
        description: Trigger script execution on clients
      - name: View Executions
        code: executor.execution.view
        description: View execution logs and output

roles:
  - name: Executor Administrator
    code: executor.admin
    description: Full access to Executor module
    is_system: true
    permissions:
      - executor.script.view
      - executor.script.manage
      - executor.assignment.manage
      - executor.execution.trigger
      - executor.execution.view

  - name: Executor Operator
    code: executor.operator
    description: Can manage scripts, assignments, and trigger executions
    is_system: true
    permissions:
      - executor.script.view
      - executor.script.manage
      - executor.assignment.manage
      - executor.execution.trigger
      - executor.execution.view

  - name: Executor Viewer
    code: executor.viewer
    description: Read-only access to Executor module
    is_system: true
    permissions:
      - executor.script.view
      - executor.execution.view
